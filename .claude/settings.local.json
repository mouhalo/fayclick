{
  "permissions": {
    "allow": [
      "Bash(git commit:*)",
      "Bash(npm run build:*)",
      "Bash(npm run deploy:build:*)",
      "Bash(git add:*)",
      "Bash(git checkout:*)",
      "Bash(git merge:*)",
      "Bash(git push:*)",
      "Bash(git restore:*)",
      "Bash(npm run deploy:*)",
      "Bash(gh pr create --title \"🚀 Implémentation PWA Complète avec Installation Intelligente\" --body \"$(cat <<''EOF''\n## 🎯 Objectif\nImplémentation complète du système PWA avec installation intelligente, tout en préservant l''accès public aux factures.\n\n## ✨ Nouvelles Fonctionnalités\n\n### 📱 Système PWA Complet\n- **Service Worker avancé** avec stratégies de cache optimisées\n- **Installation intelligente** avec détection automatique\n- **Mode offline** avec page dédiée et reconnexion automatique\n- **Notifications push** et synchronisation en arrière-plan\n\n### 🧠 Installation Intelligente\n- **Hook `useInstallPrompt`** : Gestion complète avec localStorage\n- **Modal moderne** : Design attractif avec animations Framer Motion\n- **Logique respectueuse** : Max 3 fermetures, délai de 7 jours entre prompts\n- **Badge discret** : Indicateur d''installation après 5 secondes\n\n### 🔒 Protection Pages Publiques\n- **Exclusion automatique** des pages factures (`/facture`, `/fay`)\n- **Accès préservé** pour login/register/inscription-success\n- **Pas de contrainte d''installation** pour les visiteurs\n\n## 🛠️ Composants Ajoutés\n\n### Core PWA\n- `public/service-worker.js` - Service Worker avec cache intelligent\n- `hooks/useInstallPrompt.ts` - Hook de gestion d''installation\n- `components/pwa/InstallPromptModal.tsx` - Modal d''installation\n- `components/pwa/PWAInstallProvider.tsx` - Provider global PWA\n- `app/offline/page.tsx` - Page mode offline\n\n### Configuration\n- `manifest.json` amélioré avec toutes les capacités PWA\n- `next.config.ts` avec headers de sécurité\n- `app/layout.tsx` intégration PWAInstallProvider\n\n## 📋 Stratégies de Cache\n\n### Cache-First (Assets Statiques)\n- CSS, JS, images, fonts\n- Assets Next.js (_next/static, _next/image)\n- Performance optimale\n\n### Network-First (Pages)\n- Pages dynamiques avec fallback cache\n- APIs toujours réseau avec fallback\n- Pages publiques accessibles offline\n\n## 🎨 Expérience Utilisateur\n\n### Installation Proactive\n```typescript\n// Logique d''installation intelligente\n- Prompt après 2 secondes sur pages privées\n- Badge permanent après 5 secondes si non installé\n- Respect des préférences utilisateur\n- Exclusion automatique pages publiques\n```\n\n### Mode Offline\n- Page dédiée avec animations\n- Détection de reconnexion automatique\n- Boutons de retry et retour accueil\n- Status indicator en temps réel\n\n## 🔧 Configuration Technique\n\n### Manifest PWA\n- Nom : \"FayClick - La Super App des Marchands\"\n- Mode standalone avec fallbacks\n- Raccourcis : Dashboard, Factures, Clients\n- Support partage natif\n\n### Service Worker\n- Cache statique : assets essentiels\n- Cache dynamique : pages visitées\n- Sync background pour données\n- Notifications push ready\n\n## 🧪 Tests à Effectuer\n\n### Installation PWA\n1. Ouvrir Chrome DevTools > Application > Service Workers\n2. Vérifier l''enregistrement du Service Worker\n3. Tester le prompt d''installation sur pages privées\n4. Vérifier l''exclusion sur `/facture?token=xxx`\n\n### Mode Offline\n1. Désactiver la connexion réseau\n2. Naviguer vers `/offline`\n3. Tester la reconnexion automatique\n4. Vérifier le cache des pages visitées\n\n### Performance\n1. Lighthouse PWA score\n2. Temps de chargement avec cache\n3. Fonctionnement standalone\n\n## 📱 Compatibilité\n- ✅ Chrome/Edge (Desktop & Mobile)\n- ✅ Safari iOS (Add to Home Screen)\n- ✅ Firefox (avec limitations)\n- ✅ Samsung Internet\n- ✅ Mode standalone complet\n\n## 🚀 Déploiement\nAprès merge, utiliser `npm run deploy:build` pour déploiement complet.\n\n## 🔍 Points de Vérification\n- [ ] Service Worker s''enregistre correctement\n- [ ] Modal d''installation apparaît sur pages privées\n- [ ] Pages publiques accessibles sans installation\n- [ ] Mode offline fonctionnel\n- [ ] Cache des assets optimisé\n- [ ] Score Lighthouse PWA > 90\n\n🤖 Generated with [Claude Code](https://claude.ai/code)\nEOF\n)\")"
    ],
    "deny": [],
    "ask": []
  }
}